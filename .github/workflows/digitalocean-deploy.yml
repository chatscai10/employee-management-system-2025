name: ğŸŒŠ DigitalOcean éƒ¨ç½²

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - name: â˜ï¸ æª¢å‡ºä»£ç¢¼
      uses: actions/checkout@v4

    - name: ğŸ³ æ§‹å»ºå’Œæ¨é€åˆ° DOCR
      uses: digitalocean/action-doctl@v2
      with:
        token: ${{ secrets.DIGITALOCEAN_ACCESS_TOKEN }}
    
    - name: ğŸš€ éƒ¨ç½²åˆ° App Platform
      uses: digitalocean/app_action@v1.1.5
      with:
        app_name: employee-management-system
        token: ${{ secrets.DIGITALOCEAN_ACCESS_TOKEN }}
        images: '[
          {
            "name": "web",
            "image": {
              "registry_type": "DOCR", 
              "repository": "${{ secrets.REGISTRY_NAME }}/employee-management-system",
              "tag": "latest"
            }
          }
        ]'