# ğŸ“š ä¼æ¥­å“¡å·¥ç®¡ç†ç³»çµ± - å®Œæ•´åŠŸèƒ½è¦æ ¼èªªæ˜æ›¸

## ğŸ“‹ æ–‡æª”èªªæ˜

æœ¬æ–‡æª”æ•´åˆäº†æ‰€æœ‰ç‰ˆæœ¬çš„åŠŸèƒ½è¨­è¨ˆï¼Œæä¾›æ¯å€‹æ¨¡çµ„çš„è©³ç´°è¦æ ¼èªªæ˜ï¼ŒåŒ…å«ï¼š
- åŠŸèƒ½æè¿°
- æ¥­å‹™é‚è¼¯
- è³‡æ–™æµç¨‹
- APIè¦æ ¼
- UI/UXè¨­è¨ˆ
- éŒ¯èª¤è™•ç†

---

## ğŸ” 1. èº«ä»½èªè­‰ç³»çµ±

### 1.1 ç™»å…¥åŠŸèƒ½

#### åŠŸèƒ½æè¿°
æ”¯æ´å…©ç¨®ç™»å…¥æ–¹å¼ï¼Œæä¾›å®‰å…¨çš„èº«ä»½é©—è­‰æ©Ÿåˆ¶ã€‚

#### ç™»å…¥æ–¹å¼
1. **å“¡å·¥ç·¨è™Ÿ + å¯†ç¢¼**
2. **èº«åˆ†è­‰è™Ÿ + å¯†ç¢¼**

#### API ç«¯é»
```http
POST /api/auth/login
```

#### è«‹æ±‚æ ¼å¼
```json
{
  "username": "john.doe æˆ– A123456789",
  "password": "password123"
}
```

#### å›æ‡‰æ ¼å¼
```json
{
  "success": true,
  "token": "eyJhbGciOiJIUzI1NiIs...",
  "user": {
    "id": 1,
    "name": "ç´„ç¿°Â·å¤šä¼Š",
    "role": "employee",
    "department": "ITéƒ¨é–€"
  }
}
```

#### æ¥­å‹™é‚è¼¯
```javascript
1. é©—è­‰è¼¸å…¥æ ¼å¼
2. æŸ¥è©¢å“¡å·¥è³‡æ–™
3. é©—è­‰å¯†ç¢¼ï¼ˆæ‡‰ä½¿ç”¨bcryptï¼‰
4. ç”ŸæˆJWT tokenï¼ˆæœ‰æ•ˆæœŸ7å¤©ï¼‰
5. è¨˜éŒ„ç™»å…¥æ—¥èªŒ
6. è¿”å›ç”¨æˆ¶è³‡è¨Š
```

#### éŒ¯èª¤è™•ç†
- `401`: å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤
- `429`: ç™»å…¥å˜—è©¦æ¬¡æ•¸éå¤šï¼ˆ5æ¬¡/15åˆ†é˜ï¼‰
- `500`: ç³»çµ±éŒ¯èª¤

### 1.2 ç™»å‡ºåŠŸèƒ½

#### API ç«¯é»
```http
POST /api/auth/logout
```

#### æ¥­å‹™é‚è¼¯
```javascript
1. é©—è­‰tokenæœ‰æ•ˆæ€§
2. å°‡tokenåŠ å…¥é»‘åå–®
3. æ¸…é™¤æœƒè©±è³‡æ–™
4. è¨˜éŒ„ç™»å‡ºæ—¥èªŒ
```

---

## â° 2. æ‰“å¡ç³»çµ±

### 2.1 GPSæ‰“å¡åŠŸèƒ½

#### åŠŸèƒ½æè¿°
ä½¿ç”¨GPSå®šä½ç¢ºä¿å“¡å·¥åœ¨æŒ‡å®šç¯„åœå…§æ‰“å¡ï¼Œä¸¦è¨˜éŒ„è¨­å‚™æŒ‡ç´‹é˜²æ­¢ä»£æ‰“å¡ã€‚

#### æ‰“å¡é¡å‹
- **ä¸Šç­æ‰“å¡**
- **ä¸‹ç­æ‰“å¡**

#### API ç«¯é»
```http
POST /api/attendance/clock-in
POST /api/attendance/clock-out
```

#### è«‹æ±‚æ ¼å¼
```json
{
  "employeeId": 1,
  "type": "ä¸Šç­",
  "storeName": "å…§å£¢åº—",
  "gpsCoordinates": "24.9748412,121.2556713",
  "deviceFingerprint": "hash-string",
  "timestamp": "2025-01-10T09:00:00Z"
}
```

#### GPSé©—è­‰é‚è¼¯
```javascript
function validateLocation(userLat, userLng, storeLat, storeLng) {
  const R = 6371e3; // åœ°çƒåŠå¾‘ï¼ˆç±³ï¼‰
  const Ï†1 = userLat * Math.PI/180;
  const Ï†2 = storeLat * Math.PI/180;
  const Î”Ï† = (storeLat - userLat) * Math.PI/180;
  const Î”Î» = (storeLng - userLng) * Math.PI/180;

  const a = Math.sin(Î”Ï†/2) * Math.sin(Î”Ï†/2) +
            Math.cos(Ï†1) * Math.cos(Ï†2) *
            Math.sin(Î”Î»/2) * Math.sin(Î”Î»/2);
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
  const distance = R * c;

  return distance <= 100; // 100å…¬å°ºå…§
}
```

#### è¨­å‚™æŒ‡ç´‹ç”Ÿæˆ
```javascript
function generateDeviceFingerprint() {
  const components = [
    navigator.userAgent,
    navigator.language,
    screen.width + 'x' + screen.height,
    screen.colorDepth,
    new Date().getTimezoneOffset()
  ];
  
  return CryptoJS.SHA256(components.join('|')).toString();
}
```

#### é²åˆ°åˆ¤å®šé‚è¼¯
```javascript
const workStartTime = "09:00";
const graceMinutes = 10;

function calculateLateMinutes(clockInTime, scheduledTime) {
  const actualTime = new Date(clockInTime);
  const scheduled = new Date(scheduledTime);
  const diffMinutes = (actualTime - scheduled) / 60000;
  
  return diffMinutes > graceMinutes ? Math.floor(diffMinutes) : 0;
}
```

#### Telegram é€šçŸ¥æ ¼å¼
```
ğŸ”” æ‰“å¡é€šçŸ¥

å“¡å·¥ï¼šç´„ç¿°Â·å¤šä¼Š
é¡å‹ï¼šä¸Šç­æ‰“å¡
æ™‚é–“ï¼š2025-01-10 09:05:23
åœ°é»ï¼šå…§å£¢åº—
ç‹€æ…‹ï¼šâœ… æ­£å¸¸
è·é›¢ï¼š25å…¬å°º
```

---

## ğŸ’° 3. ç‡Ÿæ”¶ç®¡ç†ç³»çµ±

### 3.1 ç‡Ÿæ”¶è¨˜éŒ„åŠŸèƒ½

#### åŠŸèƒ½æè¿°
è¨˜éŒ„æ¯æ—¥ç‡Ÿæ¥­æ”¶æ”¯æ˜ç´°ï¼Œè‡ªå‹•è¨ˆç®—çé‡‘ï¼Œæ”¯æ´å¤šç¨®æ”¶å…¥é¡å‹ã€‚

#### API ç«¯é»
```http
POST /api/revenue/record
```

#### è«‹æ±‚æ ¼å¼
```json
{
  "date": "2025-01-10",
  "storeName": "å…§å£¢åº—",
  "revenue": {
    "ç¾å ´": 35000,
    "å¤–é€": 15000,
    "å¤–å¸¶": 8000,
    "å…¶ä»–": 2000
  },
  "expenses": {
    "é£Ÿæ": 18000,
    "äººäº‹": 12000,
    "æ°´é›»": 3000,
    "å…¶ä»–": 2000
  },
  "photos": ["base64_string1", "base64_string2"]
}
```

#### çé‡‘è¨ˆç®—é‚è¼¯
```javascript
function calculateBonus(netRevenue, targetRevenue) {
  const bonusRates = [
    { threshold: 1.5, rate: 0.05 },  // 150%ç›®æ¨™ = 5%çé‡‘
    { threshold: 1.3, rate: 0.03 },  // 130%ç›®æ¨™ = 3%çé‡‘
    { threshold: 1.1, rate: 0.02 },  // 110%ç›®æ¨™ = 2%çé‡‘
    { threshold: 1.0, rate: 0.01 }   // 100%ç›®æ¨™ = 1%çé‡‘
  ];
  
  const achievementRate = netRevenue / targetRevenue;
  
  for (const bonus of bonusRates) {
    if (achievementRate >= bonus.threshold) {
      return netRevenue * bonus.rate;
    }
  }
  
  return 0;
}
```

#### ç‡Ÿæ”¶å ±è¡¨æ ¼å¼
```
ğŸ“Š æ—¥ç‡Ÿæ”¶å ±å‘Š - 2025-01-10

ã€æ”¶å…¥æ˜ç´°ã€‘
ç¾å ´ç‡Ÿæ¥­ï¼šNT$ 35,000
å¤–é€å¹³å°ï¼šNT$ 15,000
å¤–å¸¶è‡ªå–ï¼šNT$ 8,000
å…¶ä»–æ”¶å…¥ï¼šNT$ 2,000
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ”¶å…¥ç¸½è¨ˆï¼šNT$ 60,000

ã€æ”¯å‡ºæ˜ç´°ã€‘
é£Ÿææˆæœ¬ï¼šNT$ 18,000
äººäº‹è²»ç”¨ï¼šNT$ 12,000
æ°´é›»ç“¦æ–¯ï¼šNT$ 3,000
å…¶ä»–æ”¯å‡ºï¼šNT$ 2,000
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ”¯å‡ºç¸½è¨ˆï¼šNT$ 35,000

ã€ç‡Ÿé‹ç¸¾æ•ˆã€‘
æ·¨æ”¶å…¥ï¼šNT$ 25,000
é”æˆç‡ï¼š125%
çé‡‘ï¼šNT$ 750
```

---

## ğŸ“¦ 4. åº«å­˜å«è²¨ç³»çµ±

### 4.1 å«è²¨ç”³è«‹åŠŸèƒ½

#### åŠŸèƒ½æè¿°
ç®¡ç†åº«å­˜ç‰©å“çš„è¨‚è³¼æµç¨‹ï¼Œè¿½è¹¤åˆ°è²¨ç‹€æ…‹ï¼Œè‡ªå‹•æª¢æ¸¬ç•°å¸¸ã€‚

#### API ç«¯é»
```http
POST /api/orders/create
GET /api/orders/list
PUT /api/orders/{id}/receive
```

#### å«è²¨å–®æ ¼å¼
```json
{
  "orderDate": "2025-01-10",
  "storeName": "å…§å£¢åº—",
  "items": [
    {
      "itemId": 1,
      "itemName": "é›èƒ¸è‚‰",
      "quantity": 50,
      "unit": "å…¬æ–¤",
      "unitPrice": 120,
      "supplier": "å„ªè³ªè‚‰å“"
    },
    {
      "itemId": 2,
      "itemName": "ç”Ÿèœ",
      "quantity": 30,
      "unit": "å…¬æ–¤",
      "unitPrice": 80,
      "supplier": "æ–°é®®è”¬æœ"
    }
  ],
  "expectedDelivery": "2025-01-12",
  "notes": "è«‹ç¢ºä¿å†·éˆé‹è¼¸"
}
```

#### ç•°å¸¸æª¢æ¸¬é‚è¼¯
```javascript
function detectOrderAnomalies(currentOrder, historicalOrders) {
  const anomalies = [];
  
  // æª¢æ¸¬æ•¸é‡ç•°å¸¸ï¼ˆè¶…éæ­·å²å¹³å‡å€¼çš„150%ï¼‰
  const avgQuantity = calculateAverage(historicalOrders, 'quantity');
  if (currentOrder.quantity > avgQuantity * 1.5) {
    anomalies.push({
      type: 'QUANTITY_SPIKE',
      message: `æ•¸é‡ç•°å¸¸ï¼š${currentOrder.quantity} (å¹³å‡ï¼š${avgQuantity})`
    });
  }
  
  // æª¢æ¸¬åƒ¹æ ¼ç•°å¸¸ï¼ˆè¶…éæ­·å²å¹³å‡åƒ¹æ ¼çš„120%ï¼‰
  const avgPrice = calculateAverage(historicalOrders, 'unitPrice');
  if (currentOrder.unitPrice > avgPrice * 1.2) {
    anomalies.push({
      type: 'PRICE_INCREASE',
      message: `åƒ¹æ ¼ä¸Šæ¼²ï¼š${currentOrder.unitPrice} (å¹³å‡ï¼š${avgPrice})`
    });
  }
  
  // æª¢æ¸¬é‡è¤‡å«è²¨ï¼ˆ24å°æ™‚å…§ç›¸åŒå“é …ï¼‰
  const recentOrder = findRecentOrder(historicalOrders, currentOrder.itemId, 24);
  if (recentOrder) {
    anomalies.push({
      type: 'DUPLICATE_ORDER',
      message: `24å°æ™‚å…§é‡è¤‡å«è²¨`
    });
  }
  
  return anomalies;
}
```

---

## ğŸ“… 5. æ’ç­ç®¡ç†ç³»çµ±

### 5.1 å“¡å·¥æ’ç­ç”³è«‹

#### åŠŸèƒ½æè¿°
å“¡å·¥è‡ªä¸»é¸æ“‡å¯ä¸Šç­æ™‚æ®µï¼Œç³»çµ±è‡ªå‹•é¿å…è¡çªï¼Œç®¡ç†å“¡æœ€çµ‚åˆ†é…ã€‚

#### ç”³è«‹æµç¨‹
```
å“¡å·¥é¸æ“‡æ™‚æ®µ â†’ ç³»çµ±é©—è­‰ â†’ å„²å­˜åå¥½ â†’ ç®¡ç†å“¡åˆ†é… â†’ ç™¼å¸ƒæ’ç­è¡¨
```

#### API ç«¯é»
```http
POST /api/schedules/request
GET /api/schedules/my-schedule
POST /api/schedules/admin/assign
```

#### è¡çªæª¢æ¸¬é‚è¼¯
```javascript
function detectScheduleConflicts(newSchedule, existingSchedules) {
  const conflicts = [];
  
  for (const existing of existingSchedules) {
    // æª¢æŸ¥æ™‚é–“é‡ç–Š
    if (isTimeOverlap(newSchedule, existing)) {
      conflicts.push({
        type: 'TIME_OVERLAP',
        conflictWith: existing.employeeName,
        time: `${existing.date} ${existing.shift}`
      });
    }
    
    // æª¢æŸ¥æœ€å°ä¼‘æ¯æ™‚é–“ï¼ˆè‡³å°‘8å°æ™‚ï¼‰
    const restHours = calculateRestHours(newSchedule, existing);
    if (restHours < 8) {
      conflicts.push({
        type: 'INSUFFICIENT_REST',
        hours: restHours,
        message: 'ä¼‘æ¯æ™‚é–“ä¸è¶³8å°æ™‚'
      });
    }
  }
  
  return conflicts;
}
```

#### æ™ºæ…§æ’ç­æ¼”ç®—æ³•
```javascript
function optimizeSchedule(requests, constraints) {
  // 1. æ ¹æ“šå“¡å·¥åå¥½åˆ†æ•¸æ’åº
  const sortedRequests = requests.sort((a, b) => 
    b.preferenceScore - a.preferenceScore
  );
  
  // 2. æ‡‰ç”¨ç´„æŸæ¢ä»¶
  const schedule = [];
  for (const request of sortedRequests) {
    if (meetsConstraints(request, schedule, constraints)) {
      schedule.push(request);
    }
  }
  
  // 3. å¡«è£œç©ºç¼º
  fillGaps(schedule, constraints);
  
  // 4. å¹³è¡¡å·¥ä½œé‡
  balanceWorkload(schedule);
  
  return schedule;
}
```

---

## ğŸ—³ï¸ 6. å‡é·æŠ•ç¥¨ç³»çµ±

### 6.1 æ°‘ä¸»å‡é·æ©Ÿåˆ¶

#### åŠŸèƒ½æè¿°
é€éå“¡å·¥æŠ•ç¥¨æ±ºå®šå‡é·ï¼Œç¢ºä¿å…¬å¹³é€æ˜çš„æ™‰å‡æ©Ÿæœƒã€‚

#### æŠ•ç¥¨æµç¨‹
```
ç™¼èµ·å‡é·ç”³è«‹ â†’ è³‡æ ¼å¯©æ ¸ â†’ é–‹å•ŸæŠ•ç¥¨ â†’ åŒ¿åæŠ•ç¥¨ â†’ çµæœå…¬å¸ƒ â†’ åŸ·è¡Œå‡é·
```

#### API ç«¯é»
```http
POST /api/promotion/initiate
GET /api/promotion/active
POST /api/promotion/vote
GET /api/promotion/results
```

#### æŠ•ç¥¨è³‡æ ¼é©—è­‰
```javascript
function validateVotingEligibility(employee, targetPosition) {
  const eligibility = {
    qualified: true,
    reasons: []
  };
  
  // å¹´è³‡è¦æ±‚
  const requiredYears = getPositionRequirement(targetPosition, 'years');
  if (employee.yearsOfService < requiredYears) {
    eligibility.qualified = false;
    eligibility.reasons.push(`å¹´è³‡ä¸è¶³ï¼šéœ€è¦${requiredYears}å¹´`);
  }
  
  // ç¸¾æ•ˆè¦æ±‚
  const requiredPerformance = getPositionRequirement(targetPosition, 'performance');
  if (employee.performanceScore < requiredPerformance) {
    eligibility.qualified = false;
    eligibility.reasons.push(`ç¸¾æ•ˆä¸è¶³ï¼šéœ€è¦${requiredPerformance}åˆ†`);
  }
  
  // æŠ•ç¥¨å†·å»æœŸï¼ˆä¸Šæ¬¡å‡é·å¾Œ6å€‹æœˆï¼‰
  const lastPromotion = getLastPromotion(employee.id);
  if (lastPromotion && daysSince(lastPromotion) < 180) {
    eligibility.qualified = false;
    eligibility.reasons.push('éœ€ç­‰å¾…6å€‹æœˆå†·å»æœŸ');
  }
  
  return eligibility;
}
```

#### åŒ¿åæŠ•ç¥¨æ©Ÿåˆ¶
```javascript
function castAnonymousVote(voterId, promotionId, decision) {
  // ç”ŸæˆåŒ¿åæŠ•ç¥¨ID
  const anonymousId = generateAnonymousId(voterId, promotionId);
  
  // é©—è­‰æœªé‡è¤‡æŠ•ç¥¨
  if (hasVoted(anonymousId, promotionId)) {
    throw new Error('å·²ç¶“æŠ•éç¥¨');
  }
  
  // è¨˜éŒ„æŠ•ç¥¨ï¼ˆä¸å„²å­˜voterIdï¼‰
  const vote = {
    id: generateId(),
    promotionId: promotionId,
    anonymousId: anonymousId,
    decision: decision, // 'approve' or 'reject'
    timestamp: new Date(),
    ipHash: hashIP(getClientIP())
  };
  
  saveVote(vote);
  updateVoteCount(promotionId, decision);
}
```

---

## ğŸ”§ 7. ç¶­ä¿®ç®¡ç†ç³»çµ±

### 7.1 è¨­å‚™å ±ä¿®åŠŸèƒ½

#### åŠŸèƒ½æè¿°
å¿«é€Ÿå ±ä¿®è¨­å‚™å•é¡Œï¼Œè¿½è¹¤ç¶­ä¿®é€²åº¦ï¼Œç®¡ç†ç¶­ä¿®æˆæœ¬ã€‚

#### API ç«¯é»
```http
POST /api/maintenance/report
GET /api/maintenance/list
PUT /api/maintenance/{id}/update
```

#### å ±ä¿®å–®æ ¼å¼
```json
{
  "reportDate": "2025-01-10",
  "storeName": "å…§å£¢åº—",
  "equipment": "å†·å‡åº«",
  "issue": "æº«åº¦ç•°å¸¸ä¸Šå‡",
  "priority": "high",
  "description": "å†·å‡åº«æº«åº¦å¾-18Â°Cä¸Šå‡åˆ°-10Â°C",
  "photos": ["base64_photo1", "base64_photo2"],
  "reportedBy": 1
}
```

#### å„ªå…ˆç´šåˆ¤å®šé‚è¼¯
```javascript
function determinePriority(equipment, issue) {
  const criticalEquipment = ['å†·å‡åº«', 'å†·è—åº«', 'ç“¦æ–¯çˆ', 'POSæ©Ÿ'];
  const urgentKeywords = ['ç„¡æ³•ä½¿ç”¨', 'å®Œå…¨æ•…éšœ', 'æ¼æ°´', 'æ¼é›»', 'ç•°å‘³'];
  
  // é—œéµè¨­å‚™è‡ªå‹•è¨­ç‚ºé«˜å„ªå…ˆ
  if (criticalEquipment.includes(equipment)) {
    return 'high';
  }
  
  // åŒ…å«ç·Šæ€¥é—œéµå­—è¨­ç‚ºé«˜å„ªå…ˆ
  for (const keyword of urgentKeywords) {
    if (issue.includes(keyword)) {
      return 'high';
    }
  }
  
  // å…¶ä»–æƒ…æ³æ ¹æ“šæè¿°é•·åº¦åˆ¤æ–·
  return issue.length > 50 ? 'medium' : 'low';
}
```

#### ç¶­ä¿®é€²åº¦è¿½è¹¤
```javascript
const maintenanceStates = {
  REPORTED: 'å·²å ±ä¿®',
  ASSIGNED: 'å·²æŒ‡æ´¾',
  IN_PROGRESS: 'ç¶­ä¿®ä¸­',
  COMPLETED: 'å·²å®Œæˆ',
  VERIFIED: 'å·²é©—æ”¶'
};

function updateMaintenanceStatus(maintenanceId, newStatus, updatedBy) {
  const maintenance = getMaintenanceById(maintenanceId);
  
  // é©—è­‰ç‹€æ…‹è½‰æ›åˆæ³•æ€§
  if (!isValidTransition(maintenance.status, newStatus)) {
    throw new Error('ç„¡æ•ˆçš„ç‹€æ…‹è½‰æ›');
  }
  
  // æ›´æ–°ç‹€æ…‹
  maintenance.status = newStatus;
  maintenance.lastUpdated = new Date();
  maintenance.updatedBy = updatedBy;
  
  // ç‰¹æ®Šè™•ç†
  if (newStatus === 'COMPLETED') {
    maintenance.completedAt = new Date();
    calculateMaintenanceCost(maintenance);
  }
  
  // ç™¼é€é€šçŸ¥
  notifyMaintenanceUpdate(maintenance);
  
  return maintenance;
}
```

---

## ğŸ“¢ 8. é€šçŸ¥ç³»çµ±

### 8.1 Telegram æ•´åˆ

#### åŠŸèƒ½æè¿°
å³æ™‚æ¨é€é‡è¦é€šçŸ¥åˆ°æŒ‡å®šTelegramç¾¤çµ„ï¼Œæ”¯æ´åˆ†ç´šé€šçŸ¥ã€‚

#### é€šçŸ¥é¡å‹
```javascript
const notificationTypes = {
  CLOCK_IN: 'æ‰“å¡é€šçŸ¥',
  REVENUE: 'ç‡Ÿæ”¶é€šçŸ¥',
  ORDER: 'å«è²¨é€šçŸ¥',
  MAINTENANCE: 'ç¶­ä¿®é€šçŸ¥',
  PROMOTION: 'å‡é·é€šçŸ¥',
  ALERT: 'ç•°å¸¸è­¦å ±',
  SYSTEM: 'ç³»çµ±é€šçŸ¥'
};
```

#### é€šçŸ¥æ ¼å¼åŒ–
```javascript
function formatTelegramMessage(type, data) {
  const templates = {
    CLOCK_IN: (d) => `
ğŸ”” ${d.type}æ‰“å¡é€šçŸ¥

ğŸ‘¤ å“¡å·¥ï¼š${d.employeeName}
ğŸ“ åœ°é»ï¼š${d.storeName}
â° æ™‚é–“ï¼š${d.time}
ğŸ“ è·é›¢ï¼š${d.distance}å…¬å°º
${d.isLate ? `âš ï¸ é²åˆ°ï¼š${d.lateMinutes}åˆ†é˜` : 'âœ… æº–æ™‚'}
    `,
    
    REVENUE: (d) => `
ğŸ’° ç‡Ÿæ”¶é€šçŸ¥ - ${d.date}

ğŸª åˆ†åº—ï¼š${d.storeName}
ğŸ’µ ç¸½æ”¶å…¥ï¼šNT$ ${d.totalRevenue.toLocaleString()}
ğŸ’¸ ç¸½æ”¯å‡ºï¼šNT$ ${d.totalExpense.toLocaleString()}
ğŸ’ æ·¨æ”¶å…¥ï¼šNT$ ${d.netRevenue.toLocaleString()}
ğŸ“Š é”æˆç‡ï¼š${d.achievementRate}%
ğŸ çé‡‘ï¼šNT$ ${d.bonus.toLocaleString()}
    `,
    
    ALERT: (d) => `
ğŸš¨ ç•°å¸¸è­¦å ±ï¼

é¡å‹ï¼š${d.alertType}
èªªæ˜ï¼š${d.description}
æ™‚é–“ï¼š${d.timestamp}
å»ºè­°ï¼š${d.suggestion}
    `
  };
  
  return templates[type](data);
}
```

#### åˆ†ç´šé€šçŸ¥é‚è¼¯
```javascript
function sendNotification(type, data, priority = 'normal') {
  const channels = {
    high: [BOSS_GROUP_ID, MANAGER_GROUP_ID],
    normal: [MANAGER_GROUP_ID],
    low: [EMPLOYEE_GROUP_ID]
  };
  
  const targetChannels = channels[priority] || channels.normal;
  const message = formatTelegramMessage(type, data);
  
  for (const channelId of targetChannels) {
    sendToTelegram(channelId, message);
  }
}
```

---

## ğŸ”’ 9. å®‰å…¨æ©Ÿåˆ¶

### 9.1 èº«ä»½é©—è­‰

#### JWT Token çµæ§‹
```javascript
{
  "header": {
    "alg": "HS256",
    "typ": "JWT"
  },
  "payload": {
    "userId": 1,
    "username": "john.doe",
    "role": "employee",
    "iat": 1704873600,
    "exp": 1705478400
  }
}
```

### 9.2 æ¬Šé™æ§åˆ¶

#### è§’è‰²æ¬Šé™çŸ©é™£
| åŠŸèƒ½ | å“¡å·¥ | ä¸»ç®¡ | ç®¡ç†å“¡ |
|------|------|------|--------|
| æ‰“å¡ | âœ… | âœ… | âœ… |
| æŸ¥çœ‹å€‹äººè³‡æ–™ | âœ… | âœ… | âœ… |
| æŸ¥çœ‹ä»–äººè³‡æ–™ | âŒ | âœ… | âœ… |
| ç‡Ÿæ”¶è¨˜éŒ„ | âœ… | âœ… | âœ… |
| æŸ¥çœ‹ç‡Ÿæ”¶å ±è¡¨ | âŒ | âœ… | âœ… |
| å«è²¨ç”³è«‹ | âœ… | âœ… | âœ… |
| å¯©æ ¸å«è²¨ | âŒ | âœ… | âœ… |
| æ’ç­ç”³è«‹ | âœ… | âœ… | âœ… |
| åˆ†é…æ’ç­ | âŒ | âŒ | âœ… |
| ç™¼èµ·å‡é· | âœ… | âœ… | âœ… |
| ç³»çµ±è¨­å®š | âŒ | âŒ | âœ… |

### 9.3 è³‡æ–™åŠ å¯†

#### æ•æ„Ÿè³‡æ–™è™•ç†
```javascript
// å¯†ç¢¼åŠ å¯†
const bcrypt = require('bcryptjs');
const saltRounds = 10;

async function hashPassword(password) {
  return await bcrypt.hash(password, saltRounds);
}

// èº«åˆ†è­‰è™Ÿé®ç½©
function maskIdNumber(idNumber) {
  return idNumber.substring(0, 3) + '****' + idNumber.substring(7);
}

// APIå›æ‡‰éæ¿¾
function filterSensitiveData(data) {
  const filtered = { ...data };
  delete filtered.password;
  delete filtered.idNumber;
  return filtered;
}
```

---

## ğŸ“Š 10. è³‡æ–™åˆ†æåŠŸèƒ½

### 10.1 ç‡Ÿé‹å„€è¡¨æ¿

#### é—œéµæŒ‡æ¨™ï¼ˆKPIï¼‰
```javascript
const kpiMetrics = {
  // ç‡Ÿæ”¶æŒ‡æ¨™
  dailyRevenue: 'æ—¥ç‡Ÿæ”¶',
  monthlyRevenue: 'æœˆç‡Ÿæ”¶',
  revenueGrowth: 'ç‡Ÿæ”¶æˆé•·ç‡',
  averageTransaction: 'å¹³å‡äº¤æ˜“é¡',
  
  // äººåŠ›æŒ‡æ¨™
  attendanceRate: 'å‡ºå‹¤ç‡',
  lateRate: 'é²åˆ°ç‡',
  overtimeHours: 'åŠ ç­æ™‚æ•¸',
  employeeTurnover: 'é›¢è·ç‡',
  
  // ç‡Ÿé‹æŒ‡æ¨™
  inventoryTurnover: 'åº«å­˜é€±è½‰ç‡',
  maintenanceCost: 'ç¶­ä¿®æˆæœ¬',
  customerSatisfaction: 'é¡§å®¢æ»¿æ„åº¦'
};
```

### 10.2 å ±è¡¨ç”Ÿæˆ

#### æœˆåº¦ç‡Ÿé‹å ±è¡¨
```javascript
function generateMonthlyReport(year, month) {
  const report = {
    period: `${year}å¹´${month}æœˆ`,
    revenue: calculateMonthlyRevenue(year, month),
    expenses: calculateMonthlyExpenses(year, month),
    profit: calculateProfit(year, month),
    attendance: generateAttendanceReport(year, month),
    inventory: generateInventoryReport(year, month),
    maintenance: generateMaintenanceReport(year, month),
    trends: analyzeTrends(year, month),
    recommendations: generateRecommendations()
  };
  
  return report;
}
```

---

## ğŸ¯ ç¸½çµ

æœ¬åŠŸèƒ½è¦æ ¼èªªæ˜æ›¸æ¶µè“‹äº†ä¼æ¥­å“¡å·¥ç®¡ç†ç³»çµ±çš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„ï¼Œæ¯å€‹åŠŸèƒ½éƒ½åŒ…å«ï¼š
- æ˜ç¢ºçš„æ¥­å‹™é‚è¼¯
- æ¨™æº–çš„APIè¨­è¨ˆ
- å®Œæ•´çš„éŒ¯èª¤è™•ç†
- è©³ç´°çš„å¯¦ç¾ä»£ç¢¼

é€™ä»½æ–‡æª”å¯ä½œç‚ºé–‹ç™¼åœ˜éšŠçš„å¯¦æ–½æŒ‡å—ï¼Œç¢ºä¿ç³»çµ±åŠŸèƒ½çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚

---

**æ–‡æª”ç‰ˆæœ¬**: v1.0  
**æ›´æ–°æ—¥æœŸ**: 2025-01-10  
**ç·¨æ’°åœ˜éšŠ**: AIé–‹ç™¼å°çµ„