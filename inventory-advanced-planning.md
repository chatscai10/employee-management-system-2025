# å«è²¨ç³»çµ±é€²éšŽåŠŸèƒ½è¦åŠƒæ›¸

## ðŸ“‹ éœ€æ±‚åˆ†æž

### 1. é€²éšŽç•°å¸¸ç›£æŽ§éœ€æ±‚
- **å“é …å¤ªå¤šå¤©æ²’å«è²¨**: æ¯å€‹å“é …è¨­å®šä¸åŒçš„ç•°å¸¸å¤©æ•¸é–¾å€¼
- **å“é …å«è²¨æ¬¡æ•¸å¤ªé »ç¹**: æ¯å€‹å“é …è¨­å®šä¸åŒçš„é »ç¹å«è²¨æª¢æ¸¬æœŸé–“
- **æ–°å“é …ç„¡å«è²¨è¨˜éŒ„**: æª¢æ¸¬ä¸Šæž¶å¾Œå¾žæœªå«è²¨çš„å“é …
- **åº«å­˜ä½Žæ–¼è­¦æˆ’å€¼**: æ¯å€‹å“é …è¨­å®šä¸åŒçš„ä½Žåº«å­˜è­¦æˆ’å€¼

### 2. åº«å­˜ç®¡ç†éœ€æ±‚
- **å“é …å€‹åˆ¥åŒ–è¨­å®š**: æ¯å€‹å“é …ç¨ç«‹çš„åº«å­˜ç®¡ç†åƒæ•¸
- **æ¬Šé™åˆ†ç´š**: å“¡å·¥åƒ…èƒ½çœ‹å‚™è¨»ï¼Œåº«å­˜æ•¸é‡åƒ…ç®¡ç†å“¡å¯è¦‹
- **è‡ªå‹•åº«å­˜æ›´æ–°**: å«è²¨å¾Œè‡ªå‹•æ›´æ–°é æœŸåº«å­˜
- **åº«å­˜è¿½è¹¤**: è¨˜éŒ„åº«å­˜è®Šå‹•æ­·å²

## ðŸ—ï¸ è³‡æ–™åº«è¨­è¨ˆå¼·åŒ–

### InventoryItem æ¨¡åž‹å¢žå¼·
```sql
-- æ–°å¢žæ¬„ä½ï¼š
employeeNotes TEXT,           -- å“¡å·¥å¯è¦‹å‚™è¨»
managerNotes TEXT,           -- ç®¡ç†å“¡å°ˆç”¨å‚™è¨»
frequentOrderDays INTEGER,   -- é »ç¹å«è²¨æª¢æ¸¬å¤©æ•¸
maxOrdersInPeriod INTEGER,   -- æœŸé–“å…§æœ€å¤§å«è²¨æ¬¡æ•¸
lowStockThreshold INTEGER,   -- ä½Žåº«å­˜è­¦æˆ’å€¼
autoRestockLevel INTEGER,    -- è‡ªå‹•è£œè²¨å»ºè­°é‡
category TEXT,               -- å“é …åˆ†é¡ž
priority INTEGER,            -- å„ªå…ˆç´š (1=é«˜ 2=ä¸­ 3=ä½Ž)
seasonalItem BOOLEAN,        -- æ˜¯å¦ç‚ºå­£ç¯€æ€§å•†å“
supplierLeadTime INTEGER     -- ä¾›æ‡‰å•†äº¤è²¨æ™‚é–“(å¤©)
```

### æ–°å¢ž InventoryLog æ¨¡åž‹
```sql
CREATE TABLE inventory_logs (
    id INTEGER PRIMARY KEY,
    itemId INTEGER,
    actionType TEXT,         -- 'order', 'consume', 'adjust', 'waste'
    quantityBefore INTEGER,
    quantityAfter INTEGER,
    quantityChange INTEGER,
    reason TEXT,
    operatorId INTEGER,
    operatorName TEXT,
    createdAt DATETIME
);
```

### æ–°å¢ž InventoryAlert æ¨¡åž‹
```sql
CREATE TABLE inventory_alerts (
    id INTEGER PRIMARY KEY,
    itemId INTEGER,
    alertType TEXT,          -- 'low_stock', 'no_order', 'frequent_order', 'new_item'
    severity INTEGER,        -- 1=ä½Ž 2=ä¸­ 3=é«˜
    message TEXT,
    isResolved BOOLEAN,
    resolvedAt DATETIME,
    resolvedBy INTEGER,
    createdAt DATETIME
);
```

## ðŸ§  æ™ºèƒ½ç›£æŽ§å¼•æ“Žè¨­è¨ˆ

### 1. ç•°å¸¸æª¢æ¸¬ç®—æ³•
```javascript
class AdvancedAbnormalEngine {
    // æª¢æ¸¬å¤ªä¹…æ²’å«è²¨
    static checkNoOrderTooLong(item, lastOrderDate) {
        const daysSinceOrder = calculateDaysDiff(lastOrderDate, today);
        return daysSinceOrder > item.abnormalDays;
    }
    
    // æª¢æ¸¬å«è²¨å¤ªé »ç¹
    static checkTooFrequentOrders(item, recentOrders) {
        const ordersInPeriod = recentOrders.filter(order => 
            isWithinDays(order.date, item.frequentOrderDays)
        ).length;
        return ordersInPeriod > item.maxOrdersInPeriod;
    }
    
    // æª¢æ¸¬æ–°å“é …ç„¡å«è²¨è¨˜éŒ„
    static checkNewItemNoOrder(item) {
        const daysSinceCreated = calculateDaysDiff(item.createdAt, today);
        return daysSinceCreated > 7 && !item.lastOrderDate;
    }
    
    // æª¢æ¸¬ä½Žåº«å­˜
    static checkLowStock(item) {
        return item.currentStock <= item.lowStockThreshold;
    }
}
```

### 2. åº«å­˜ç®¡ç†ç®—æ³•
```javascript
class InventoryManager {
    // è‡ªå‹•åº«å­˜æ‰£æ¸› (å«è²¨æ™‚é ä¼°æ¶ˆè€—)
    static async updateInventoryOnOrder(itemId, orderedQuantity) {
        const item = await InventoryItem.findByPk(itemId);
        const newStock = Math.max(0, item.currentStock + orderedQuantity);
        await item.update({ currentStock: newStock });
        
        // è¨˜éŒ„åº«å­˜è®Šå‹•æ—¥èªŒ
        await InventoryLog.create({
            itemId: itemId,
            actionType: 'order',
            quantityBefore: item.currentStock,
            quantityAfter: newStock,
            quantityChange: orderedQuantity,
            reason: 'å«è²¨è£œå……åº«å­˜'
        });
    }
    
    // ç”Ÿæˆè£œè²¨å»ºè­°
    static generateRestockSuggestion(item) {
        if (item.currentStock <= item.lowStockThreshold) {
            const suggestedQuantity = item.autoRestockLevel - item.currentStock;
            return {
                itemName: item.itemName,
                currentStock: item.currentStock,
                threshold: item.lowStockThreshold,
                suggestedQuantity: Math.max(1, suggestedQuantity),
                urgency: item.currentStock === 0 ? 'critical' : 'normal'
            };
        }
        return null;
    }
}
```

## ðŸŽ¯ é€šçŸ¥ç³»çµ±å¼·åŒ–

### ç®¡ç†å“¡è©³ç´°é€šçŸ¥æ¨¡æ¿
```
ðŸ›’ å«è²¨è¨˜éŒ„è©³ç´°å ±å‘Š + åº«å­˜åˆ†æž
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“¦ å«è²¨æ˜Žç´°:
å«è²¨äººå“¡ï¼š{å“¡å·¥å§“å}
ðŸ“… é€è²¨æ—¥æœŸ: {æ—¥æœŸ}
ðŸª åˆ†åº—: {åˆ†åº—åç¨±}
ðŸ’° ç¸½é‡‘é¡: ${ç¸½é‡‘é¡}

ðŸ­ å» å•†åˆ†é¡ž:
{å» å•†åç¨±}
  â€¢ {å“é …} {æ•¸é‡} {å–®ä½} (åº«å­˜: {ç•¶å‰åº«å­˜})

âš ï¸ åº«å­˜è­¦å ±:
ðŸ“‰ ä½Žåº«å­˜è­¦å‘Š: {å“é …åˆ—è¡¨}
ðŸš¨ ç¼ºè²¨è­¦å‘Š: {é›¶åº«å­˜å“é …}
â° ç•°å¸¸å“é …åˆ†æž:
  â€¢ {å“é …}: {å¤©æ•¸}å¤©æœªå«è²¨ (é–¾å€¼:{è¨­å®šå¤©æ•¸}å¤©)
  â€¢ {å“é …}: {æ¬¡æ•¸}æ¬¡é »ç¹å«è²¨ (æœŸé–“:{å¤©æ•¸}å¤©)

ðŸ’¡ è£œè²¨å»ºè­°:
  â€¢ {å“é …}: å»ºè­°å«è²¨{æ•¸é‡}{å–®ä½}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

### å“¡å·¥ç°¡åŒ–é€šçŸ¥ (ä¸å«åº«å­˜)
```
ðŸ›’ å«è²¨è¨˜éŒ„
ðŸ“… é€è²¨æ—¥æœŸ: {æ—¥æœŸ}
ðŸª åˆ†åº—: {åˆ†åº—åç¨±}
ðŸ“¦ å«è²¨å“é …: {å“é …æ•¸}é …
ðŸ’° ç¸½åƒ¹: ${ç¸½é‡‘é¡}
```

## ðŸ” æ¬Šé™è¨­è¨ˆ

### å“¡å·¥æ¬Šé™
- âœ… æŸ¥çœ‹å“é …åç¨±ã€åˆ†é¡žã€å‚™è¨»
- âœ… æäº¤å«è²¨è¨‚å–®
- âŒ æŸ¥çœ‹åº«å­˜æ•¸é‡
- âŒ æŸ¥çœ‹æˆæœ¬åƒ¹æ ¼
- âŒ ä¿®æ”¹å“é …è¨­å®š

### ç®¡ç†å“¡æ¬Šé™
- âœ… æ‰€æœ‰å“¡å·¥æ¬Šé™
- âœ… æŸ¥çœ‹åº«å­˜æ•¸é‡å’Œè­¦å ±
- âœ… è¨­å®šå“é …åƒæ•¸
- âœ… æŸ¥çœ‹è©³ç´°åˆ†æžå ±å‘Š
- âœ… åº«å­˜æ‰‹å‹•èª¿æ•´

## ðŸ“Š å‰ç«¯ç•Œé¢è¨­è¨ˆ

### å“¡å·¥å«è²¨é é¢
```
å“é …åˆ—è¡¨:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ— é›žæŽ’             â”‚
â”‚ å¤§å¤§é£Ÿå“            â”‚
â”‚ ðŸ’¡ é…¥è„†å¤–çš®ï¼Œè‚‰è³ªé®®ç¾Ž â”‚
â”‚ [+] [-] [åŠ å…¥è³¼ç‰©è»Š]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç®¡ç†å“¡åˆ†æžé é¢
```
åº«å­˜ç›£æŽ§é¢æ¿:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ“¦ é›žæŽ’                  â”‚
â”‚ ðŸª ç•¶å‰åº«å­˜: 15åŒ…        â”‚
â”‚ âš ï¸ è­¦æˆ’å€¼: 10åŒ…          â”‚
â”‚ ðŸ“Š 7å¤©å…§å«è²¨3æ¬¡ (æ­£å¸¸)   â”‚
â”‚ ðŸ“… ä¸Šæ¬¡å«è²¨: 2å¤©å‰       â”‚
â”‚ [èª¿æ•´åº«å­˜] [ä¿®æ”¹è¨­å®š]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ”„ ç³»çµ±æµç¨‹

### å«è²¨æµç¨‹å¼·åŒ–
1. å“¡å·¥é¸æ“‡å“é … â†’ é¡¯ç¤ºå‚™è¨»ä¿¡æ¯
2. æäº¤è¨‚å–® â†’ è‡ªå‹•æ›´æ–°é æœŸåº«å­˜
3. ç•°å¸¸æª¢æ¸¬å¼•æ“Žåˆ†æž
4. ç”Ÿæˆåˆ†ç´šé€šçŸ¥ (å“¡å·¥ç°¡åŒ–/ç®¡ç†å“¡è©³ç´°)
5. è¨˜éŒ„åº«å­˜è®Šå‹•æ—¥èªŒ

### ç•°å¸¸ç›£æŽ§æµç¨‹
1. å®šæ™‚æª¢æ¸¬ä»»å‹™ (æ¯å°æ™‚åŸ·è¡Œ)
2. å¤šç¶­åº¦ç•°å¸¸åˆ†æž
3. ç”Ÿæˆè­¦å ±è¨˜éŒ„
4. æŽ¨é€é€šçŸ¥çµ¦ç®¡ç†å“¡
5. è¿½è¹¤è§£æ±ºç‹€æ…‹

## âš¡ æ€§èƒ½è€ƒé‡

- ä½¿ç”¨Redisç·©å­˜é »ç¹æŸ¥è©¢çš„å“é …è³‡æ–™
- ç•°æ­¥è™•ç†åº«å­˜è¨ˆç®—å’Œé€šçŸ¥ç™¼é€
- æ‰¹é‡è™•ç†ç•°å¸¸æª¢æ¸¬æ¸›å°‘æ•¸æ“šåº«å£“åŠ›
- åˆ†é æŸ¥è©¢å¤§é‡åº«å­˜è¨˜éŒ„

## ðŸ›¡ï¸ é‚è¼¯é©—è­‰

### æ½›åœ¨è¡çªæª¢æŸ¥
1. âœ… åº«å­˜æ•¸é‡ä¸æœƒå› ç‚ºä¸¦ç™¼æ“ä½œç”¢ç”Ÿè² å€¼
2. âœ… å“¡å·¥æ¬Šé™åš´æ ¼éš”é›¢ï¼Œç„¡æ³•è¨ªå•åº«å­˜æ•¸æ“š
3. âœ… ç•°å¸¸æª¢æ¸¬åƒæ•¸ç¨ç«‹è¨­å®šï¼Œä¸æœƒäº’ç›¸å½±éŸ¿
4. âœ… é€šçŸ¥ç³»çµ±åˆ†ç´šç™¼é€ï¼Œé¿å…ä¿¡æ¯æ´©éœ²
5. âœ… åº«å­˜è®Šå‹•æœ‰å®Œæ•´æ—¥èªŒè¿½è¹¤

### æ¥­å‹™é‚è¼¯å®Œæ•´æ€§
1. âœ… å«è²¨ â†’ åº«å­˜é æ¸¬ â†’ æ¶ˆè€— â†’ è£œè²¨ å®Œæ•´å¾ªç’°
2. âœ… ç•°å¸¸æª¢æ¸¬è¦†è“‹æ‰€æœ‰æ¥­å‹™å ´æ™¯
3. âœ… æ¬Šé™æŽ§åˆ¶ç¬¦åˆå¯¦éš›æ“ä½œéœ€æ±‚
4. âœ… é€šçŸ¥å…§å®¹ç²¾æº–åŒ¹é…ç”¨æˆ¶è§’è‰²

## ðŸ“ˆ å¯¦æ–½éšŽæ®µ

1. **éšŽæ®µ1**: è³‡æ–™åº«æ¨¡åž‹å¼·åŒ–
2. **éšŽæ®µ2**: ç•°å¸¸ç›£æŽ§å¼•æ“Žé–‹ç™¼
3. **éšŽæ®µ3**: åº«å­˜ç®¡ç†ç³»çµ±å¯¦ç¾
4. **éšŽæ®µ4**: æ¬Šé™ç³»çµ±å’ŒAPIæ›´æ–°
5. **éšŽæ®µ5**: é€šçŸ¥ç³»çµ±å¼·åŒ–
6. **éšŽæ®µ6**: å‰ç«¯ç•Œé¢èª¿æ•´
7. **éšŽæ®µ7**: å®Œæ•´æ¸¬è©¦å’Œé©—è­‰

---
**çµè«–**: æ­¤è¨­è¨ˆå®Œæ•´è¦†è“‹æ‰€æœ‰éœ€æ±‚ï¼Œé‚è¼¯åš´å¯†ç„¡è¡çªï¼Œå¯å®‰å…¨å¯¦æ–½ã€‚